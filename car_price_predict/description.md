
# Что было сделано
## 1. Базовый EDA и обработка признаков
Был сделан базовый EDA и обработка признаков.  
Сначала с GitHub были считаны тренировочный и тестовый датафреймы.  
Потом для первоначального взгляда на данные были выведены:
- 30 случайных строк тренировочного датафрейма,
- первые и последние 5 строк тестового датафрейма,
- общая информация о тренировочном и тестовом датафреймах.
Были проанализированы пропуски и явные дубликаты.  
Далее все пропуски были заполнены медианными значениями (пропуски тестового датафрейма также заполнялись медианными значениями тренировочного).
Затем из датафрейма были удалены повторяющиеся строки, а также обновлены индексы строк.
Далее была проведена работа с признаками mileage, engine, max_power и torque.  
Признак torque был удалён. Остальные признаки по своей смысловой сути являются числовыми, но из-за единиц измерения распознавались как строки и являлись категориальными. Эти признаки были приведены к числовому формату. Также признаки engine и seats были приведены к числовому типу.
Далее были рассмотрены статистики при помощи метода describe. Был сделан вывод о том, что распределения как в числовых, так и в категориальных признаках в train и test похожи, и по ним можно проводить дальнейшее обучение модели.
После этого мы приступили к визуализации данных: сделали попарные распределения числовых признаков для train и test, а также построили тепловую карту корреляций. Были сделаны соответствующие выводы относительно зависимости признаков между собой.

## 2. Обучение и сравнение моделей
Далее мы приступили к непосредственному обучению модели.  
Мы отделили целевую переменную из датафреймов. Затем построили первую простую линейную модель и посмотрели на показатели метрик R2 и MSE.
R2 train: 0.5922591702157316
MSE train: 116874153930.02855
R2 test : 0.5941419794788428
MSE test: 233298779730.45486
Далее для улучшения модели была применена стандартизация признаков для train, однако это не дало сильной прибавки в качестве. Также был определён наиболее информативный признак в предсказании цены — им оказалась максимальная мощность (max_power).
Затем мы попытались улучшить модель при помощи регуляризации, для этого воспользовались Lasso-регрессией, однако это также не дало ощутимого прироста в качестве модели. Было выявлено, что ни один из коэффициентов не был занулён в результате работы регуляризации.
После этого были подобраны оптимальные параметры модели с использованием кросс-валидации и построена модель ElasticNet. В результате grid-search пришлось обучать 200 моделей, ни один вес занулён не был, а лучшим коэффициентом регуляризации оказался alpha = 10.
Далее перебором по сетке с 10 фолдами были подобраны оптимальные параметры для ElasticNet-регрессии. Grid-search пришлось обучать 900 моделей. Гиперпараметры лучшей модели: alpha = 0.21544346900318845 и l1_ratio = 0.30000000000000004

## 3. Добавление категориальных признаков
Далее для улучшения модели были добавлены категориальные фичи.  
Сначала был удалён столбец name, так как он содержит слишком большое количество категорий.
Затем категориальные признаки и seats были закодированы методом OneHotEncoding. Во избежание мультиколлинеарности был удалён один из полученных столбцов при кодировании каждого признака.
После этого был перебран параметр регуляризации alpha для гребневой (Ridge) регрессии с помощью класса GridSearchCV, однако значительно улучшить качество прогноза не удалось.

## 4. Бизнесовая оценка модели
В следующей части была проведена оценка качества модели с точки зрения бизнеса.  
Для каждой модели была определена доля прогнозов, отличающихся от реальных цен на автомобили не более чем на 10% в обе стороны.
В результате этого анализа был сделан вывод о том, что лучшей моделью является Ridge-регрессия.

## Итоговые выводы
Наибольший прирост качества дало добавление категориальных фичей с помощью OneHotEncoding и использование модели Ridge.
К сожалению, не удалось существенно повысить качество модели по сравнению с базовыми подходами.
На мой взгляд, приложение получилось достаточно быстрым и удобным в использовании. Все сделанные визуализации получились информативными и легко читаемыми.
Из ограничений можно выделить то, что модель не может работать с любым CSV-файлом на входе. Над этим можно работать в следующих итерациях.
